# デプロイメントチェックリスト

## 🚀 Railwayデプロイ前の確認事項

### 環境変数

- [ ] `DATABASE_URL` が設定されている（PostgreSQLサービスを追加すると自動設定）
- [ ] `SECRET_KEY` が設定されている（32文字以上のランダム文字列）
- [ ] `JWT_SECRET_KEY` が設定されている（32文字以上のランダム文字列）
- [ ] `FLASK_ENV=production` が設定されている
- [ ] `PORT` は設定不要（Railwayが自動設定）

### アプリケーション設定

- [ ] `app.py` で `PORT` 環境変数を使用している
- [ ] アプリケーションが `0.0.0.0` でリッスンしている
- [ ] ヘルスチェックエンドポイント (`/api/health`) が実装されている
- [ ] エラーハンドラーが実装されている
- [ ] 構造化ログが実装されている

### データベース

- [ ] PostgreSQLサービスが追加されている
- [ ] `DATABASE_URL` が自動設定されている
- [ ] `config.py` で `postgres://` を `postgresql://` に変換している

### セキュリティ

- [ ] 本番環境用の `SECRET_KEY` を使用している
- [ ] 本番環境用の `JWT_SECRET_KEY` を使用している
- [ ] CORS設定が適切（本番環境では特定のオリジンのみ許可推奨）
- [ ] 機密情報がコードにハードコードされていない

### ログとモニタリング

- [ ] 構造化ログが実装されている
- [ ] エラーログが適切に記録される
- [ ] ヘルスチェックログが記録される
- [ ] Railwayのログエクスプローラーでログを確認できる

### パフォーマンス

- [ ] データベースインデックスが適切に設定されている
- [ ] クエリが最適化されている
- [ ] 不要な依存関係が削除されている

### テスト

- [ ] ローカル環境で動作確認済み
- [ ] データベース接続が正常に動作する
- [ ] 認証機能が正常に動作する
- [ ] 主要なAPIエンドポイントが正常に動作する

---

## 📋 デプロイ後の確認事項

### アプリケーションの起動

- [ ] Railwayダッシュボードでデプロイが成功している
- [ ] デプロイログにエラーがない
- [ ] アプリケーションが起動している（ログで確認）

### ヘルスチェック

- [ ] `/api/health` エンドポイントが応答する
- [ ] データベース接続が正常（`database: healthy`）

### 機能テスト

- [ ] ユーザー登録が動作する
- [ ] ログインが動作する
- [ ] APIエンドポイントが正常に動作する
- [ ] リアルタイム通信（Socket.IO）が動作する

### ログの確認

- [ ] 構造化ログが正しく出力されている
- [ ] エラーログがない
- [ ] 起動ログが記録されている

### パフォーマンス

- [ ] レスポンスタイムが許容範囲内
- [ ] メモリ使用量が正常
- [ ] CPU使用率が正常

---

## 🔧 トラブルシューティング

### アプリケーションが起動しない場合

1. [Railwayトラブルシューティングガイド](./RAILWAY_TROUBLESHOOTING.md) を参照
2. デプロイログを確認
3. 環境変数を確認
4. ポート設定を確認

### データベース接続エラーの場合

1. PostgreSQLサービスが起動しているか確認
2. `DATABASE_URL` が正しく設定されているか確認
3. `config.py` で接続文字列の変換を確認

### ログが表示されない場合

1. 構造化ログが正しく実装されているか確認
2. Railwayのログエクスプローラーで確認
3. CLIでログを確認: `railway logs`

---

## 📚 参考ドキュメント

- [Railwayトラブルシューティング](./RAILWAY_TROUBLESHOOTING.md)
- [モニタリングガイド](./MONITORING_GUIDE.md)
- [Railwayデプロイガイド](./RAILWAY_DEPLOY_GUIDE.md)
- [Railway Logs Documentation](https://docs.railway.com/guides/logs)

---

*このチェックリストを使用して、デプロイメントの成功を確保してください。*
